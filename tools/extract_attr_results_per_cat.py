import os
import math
import argparse
import numpy as np
from tabulate import tabulate

PACO_CATEGORIES = [{'name': 'trash_can', 'id': 23, 'image_count': 1791, 'instance_count': 2585, 'synset': 'ashcan.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'handbag', 'id': 35, 'image_count': 1775, 'instance_count': 3723, 'synset': 'bag.n.04', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'ball', 'id': 41, 'image_count': 293, 'instance_count': 739, 'synset': 'ball.n.06', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'basket', 'id': 61, 'image_count': 1541, 'instance_count': 3758, 'synset': 'basket.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'belt', 'id': 88, 'image_count': 1833, 'instance_count': 3464, 'synset': 'belt.n.02', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'bench', 'id': 90, 'image_count': 1816, 'instance_count': 4165, 'synset': 'bench.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'bicycle', 'id': 94, 'image_count': 1763, 'instance_count': 4344, 'synset': 'bicycle.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'blender', 'id': 112, 'image_count': 233, 'instance_count': 301, 'synset': 'blender.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'book', 'id': 127, 'image_count': 1819, 'instance_count': 32249, 'synset': 'book.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'bottle', 'id': 133, 'image_count': 1791, 'instance_count': 7554, 'synset': 'bottle.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'bowl', 'id': 139, 'image_count': 1822, 'instance_count': 4993, 'synset': 'bowl.n.03', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'box', 'id': 143, 'image_count': 1730, 'instance_count': 7501, 'synset': 'box.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'broom', 'id': 156, 'image_count': 91, 'instance_count': 143, 'synset': 'broom.n.01', 'frequency': 'c', 'supercategory': 'OBJECT'}, {'name': 'bucket', 'id': 160, 'image_count': 680, 'instance_count': 1296, 'synset': 'bucket.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'calculator', 'id': 184, 'image_count': 55, 'instance_count': 58, 'synset': 'calculator.n.02', 'frequency': 'c', 'supercategory': 'OBJECT'}, {'name': 'can', 'id': 192, 'image_count': 425, 'instance_count': 1356, 'synset': 'can.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'car_(automobile)', 'id': 207, 'image_count': 1820, 'instance_count': 9978, 'synset': 'car.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'carton', 'id': 220, 'image_count': 60, 'instance_count': 201, 'synset': 'carton.n.02', 'frequency': 'c', 'supercategory': 'OBJECT'}, {'name': 'cellular_telephone', 'id': 230, 'image_count': 1780, 'instance_count': 2743, 'synset': 'cellular_telephone.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'chair', 'id': 232, 'image_count': 1835, 'instance_count': 10970, 'synset': 'chair.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'clock', 'id': 271, 'image_count': 1760, 'instance_count': 2564, 'synset': 'clock.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'crate', 'id': 324, 'image_count': 237, 'instance_count': 1757, 'synset': 'crate.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'cup', 'id': 344, 'image_count': 1440, 'instance_count': 4415, 'synset': 'cup.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'dog', 'id': 378, 'image_count': 1823, 'instance_count': 2542, 'synset': 'dog.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'drill', 'id': 396, 'image_count': 18, 'instance_count': 23, 'synset': 'drill.n.01', 'frequency': 'c', 'supercategory': 'OBJECT'}, {'name': 'drum_(musical_instrument)', 'id': 399, 'image_count': 27, 'instance_count': 56, 'synset': 'drum.n.01', 'frequency': 'c', 'supercategory': 'OBJECT'}, {'name': 'earphone', 'id': 409, 'image_count': 514, 'instance_count': 732, 'synset': 'earphone.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'fan', 'id': 429, 'image_count': 549, 'instance_count': 708, 'synset': 'fan.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'glass_(drink_container)', 'id': 498, 'image_count': 1830, 'instance_count': 6121, 'synset': 'glass.n.02', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'guitar', 'id': 521, 'image_count': 189, 'instance_count': 301, 'synset': 'guitar.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'hammer', 'id': 530, 'image_count': 24, 'instance_count': 35, 'synset': 'hammer.n.02', 'frequency': 'c', 'supercategory': 'OBJECT'}, {'name': 'hat', 'id': 544, 'image_count': 1828, 'instance_count': 6661, 'synset': 'hat.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'helmet', 'id': 556, 'image_count': 1816, 'instance_count': 4593, 'synset': 'helmet.n.02', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'jar', 'id': 591, 'image_count': 402, 'instance_count': 1856, 'synset': 'jar.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'kettle', 'id': 604, 'image_count': 95, 'instance_count': 125, 'synset': 'kettle.n.01', 'frequency': 'c', 'supercategory': 'OBJECT'}, {'name': 'knife', 'id': 615, 'image_count': 1778, 'instance_count': 3351, 'synset': 'knife.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'ladder', 'id': 621, 'image_count': 607, 'instance_count': 947, 'synset': 'ladder.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'lamp', 'id': 626, 'image_count': 1715, 'instance_count': 3950, 'synset': 'lamp.n.02', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'laptop_computer', 'id': 631, 'image_count': 1752, 'instance_count': 2702, 'synset': 'laptop.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'microwave_oven', 'id': 687, 'image_count': 948, 'instance_count': 1054, 'synset': 'microwave.n.02', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'mirror', 'id': 694, 'image_count': 1814, 'instance_count': 3347, 'synset': 'mirror.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'mouse_(computer_equipment)', 'id': 705, 'image_count': 1277, 'instance_count': 1753, 'synset': 'mouse.n.04', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'mug', 'id': 708, 'image_count': 770, 'instance_count': 1695, 'synset': 'mug.n.04', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'napkin', 'id': 713, 'image_count': 1715, 'instance_count': 3814, 'synset': 'napkin.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'newspaper', 'id': 719, 'image_count': 426, 'instance_count': 1137, 'synset': 'newspaper.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'pan_(for_cooking)', 'id': 751, 'image_count': 216, 'instance_count': 604, 'synset': 'pan.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'pen', 'id': 781, 'image_count': 322, 'instance_count': 897, 'synset': 'pen.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'pencil', 'id': 782, 'image_count': 147, 'instance_count': 530, 'synset': 'pencil.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'pillow', 'id': 804, 'image_count': 1818, 'instance_count': 5838, 'synset': 'pillow.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'pipe', 'id': 811, 'image_count': 1336, 'instance_count': 4500, 'synset': 'pipe.n.02', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'plate', 'id': 818, 'image_count': 1842, 'instance_count': 4992, 'synset': 'plate.n.04', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'pliers', 'id': 821, 'image_count': 28, 'instance_count': 49, 'synset': 'pliers.n.01', 'frequency': 'c', 'supercategory': 'OBJECT'}, {'name': 'remote_control', 'id': 881, 'image_count': 1039, 'instance_count': 2301, 'synset': 'remote_control.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'plastic_bag', 'id': 898, 'image_count': 1392, 'instance_count': 3492, 'synset': 'sack.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'scarf', 'id': 921, 'image_count': 715, 'instance_count': 1250, 'synset': 'scarf.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'scissors', 'id': 923, 'image_count': 676, 'instance_count': 1299, 'synset': 'scissors.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'screwdriver', 'id': 926, 'image_count': 48, 'instance_count': 87, 'synset': 'screwdriver.n.01', 'frequency': 'c', 'supercategory': 'OBJECT'}, {'name': 'shoe', 'id': 948, 'image_count': 1809, 'instance_count': 8849, 'synset': 'shoe.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'slipper_(footwear)', 'id': 973, 'image_count': 56, 'instance_count': 118, 'synset': 'slipper.n.01', 'frequency': 'c', 'supercategory': 'OBJECT'}, {'name': 'soap', 'id': 979, 'image_count': 462, 'instance_count': 841, 'synset': 'soap.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'sponge', 'id': 999, 'image_count': 83, 'instance_count': 114, 'synset': 'sponge.n.01', 'frequency': 'c', 'supercategory': 'OBJECT'}, {'name': 'spoon', 'id': 1000, 'image_count': 1056, 'instance_count': 1996, 'synset': 'spoon.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'stool', 'id': 1018, 'image_count': 282, 'instance_count': 558, 'synset': 'stool.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'sweater', 'id': 1042, 'image_count': 912, 'instance_count': 1794, 'synset': 'sweater.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'table', 'id': 1050, 'image_count': 1757, 'instance_count': 2647, 'synset': 'table.n.02', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'tape_(sticky_cloth_or_paper)', 'id': 1061, 'image_count': 129, 'instance_count': 551, 'synset': 'tape.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'telephone', 'id': 1072, 'image_count': 740, 'instance_count': 906, 'synset': 'telephone.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'television_set', 'id': 1077, 'image_count': 1814, 'instance_count': 2097, 'synset': 'television_receiver.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'tissue_paper', 'id': 1093, 'image_count': 306, 'instance_count': 575, 'synset': 'tissue.n.02', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'towel', 'id': 1108, 'image_count': 599, 'instance_count': 2077, 'synset': 'towel.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'tray', 'id': 1117, 'image_count': 889, 'instance_count': 2272, 'synset': 'tray.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'vase', 'id': 1139, 'image_count': 1772, 'instance_count': 4748, 'synset': 'vase.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'wallet', 'id': 1156, 'image_count': 109, 'instance_count': 119, 'synset': 'wallet.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'watch', 'id': 1161, 'image_count': 1836, 'instance_count': 2581, 'synset': 'watch.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'wrench', 'id': 1196, 'image_count': 31, 'instance_count': 75, 'synset': 'wrench.n.03', 'frequency': 'c', 'supercategory': 'OBJECT'}]
PACO_NOVEL_CATEGORIES = [{'name': 'ball', 'id': 41, 'image_count': 293, 'instance_count': 739, 'synset': 'ball.n.06', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'bicycle', 'id': 94, 'image_count': 1763, 'instance_count': 4344, 'synset': 'bicycle.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'car_(automobile)', 'id': 207, 'image_count': 1820, 'instance_count': 9978, 'synset': 'car.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'clock', 'id': 271, 'image_count': 1760, 'instance_count': 2564, 'synset': 'clock.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'dog', 'id': 378, 'image_count': 1823, 'instance_count': 2542, 'synset': 'dog.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'earphone', 'id': 409, 'image_count': 514, 'instance_count': 732, 'synset': 'earphone.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'fan', 'id': 429, 'image_count': 549, 'instance_count': 708, 'synset': 'fan.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'knife', 'id': 615, 'image_count': 1778, 'instance_count': 3351, 'synset': 'knife.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'ladder', 'id': 621, 'image_count': 607, 'instance_count': 947, 'synset': 'ladder.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'microwave_oven', 'id': 687, 'image_count': 948, 'instance_count': 1054, 'synset': 'microwave.n.02', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'mirror', 'id': 694, 'image_count': 1814, 'instance_count': 3347, 'synset': 'mirror.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'mouse_(computer_equipment)', 'id': 705, 'image_count': 1277, 'instance_count': 1753, 'synset': 'mouse.n.04', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'newspaper', 'id': 719, 'image_count': 426, 'instance_count': 1137, 'synset': 'newspaper.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'scarf', 'id': 921, 'image_count': 715, 'instance_count': 1250, 'synset': 'scarf.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'soap', 'id': 979, 'image_count': 462, 'instance_count': 841, 'synset': 'soap.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'spoon', 'id': 1000, 'image_count': 1056, 'instance_count': 1996, 'synset': 'spoon.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'sweater', 'id': 1042, 'image_count': 912, 'instance_count': 1794, 'synset': 'sweater.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'table', 'id': 1050, 'image_count': 1757, 'instance_count': 2647, 'synset': 'table.n.02', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'towel', 'id': 1108, 'image_count': 599, 'instance_count': 2077, 'synset': 'towel.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}, {'name': 'watch', 'id': 1161, 'image_count': 1836, 'instance_count': 2581, 'synset': 'watch.n.01', 'frequency': 'f', 'supercategory': 'OBJECT'}]
PACO_ATTRIBUTES = [{'supercategory': 'ATTR', 'id': 0, 'name': 'black'}, {'supercategory': 'ATTR', 'id': 1, 'name': 'light_blue'}, {'supercategory': 'ATTR', 'id': 2, 'name': 'blue'}, {'supercategory': 'ATTR', 'id': 3, 'name': 'dark_blue'}, {'supercategory': 'ATTR', 'id': 4, 'name': 'light_brown'}, {'supercategory': 'ATTR', 'id': 5, 'name': 'brown'}, {'supercategory': 'ATTR', 'id': 6, 'name': 'dark_brown'}, {'supercategory': 'ATTR', 'id': 7, 'name': 'light_green'}, {'supercategory': 'ATTR', 'id': 8, 'name': 'green'}, {'supercategory': 'ATTR', 'id': 9, 'name': 'dark_green'}, {'supercategory': 'ATTR', 'id': 10, 'name': 'light_grey'}, {'supercategory': 'ATTR', 'id': 11, 'name': 'grey'}, {'supercategory': 'ATTR', 'id': 12, 'name': 'dark_grey'}, {'supercategory': 'ATTR', 'id': 13, 'name': 'light_orange'}, {'supercategory': 'ATTR', 'id': 14, 'name': 'orange'}, {'supercategory': 'ATTR', 'id': 15, 'name': 'dark_orange'}, {'supercategory': 'ATTR', 'id': 16, 'name': 'light_pink'}, {'supercategory': 'ATTR', 'id': 17, 'name': 'pink'}, {'supercategory': 'ATTR', 'id': 18, 'name': 'dark_pink'}, {'supercategory': 'ATTR', 'id': 19, 'name': 'light_purple'}, {'supercategory': 'ATTR', 'id': 20, 'name': 'purple'}, {'supercategory': 'ATTR', 'id': 21, 'name': 'dark_purple'}, {'supercategory': 'ATTR', 'id': 22, 'name': 'light_red'}, {'supercategory': 'ATTR', 'id': 23, 'name': 'red'}, {'supercategory': 'ATTR', 'id': 24, 'name': 'dark_red'}, {'supercategory': 'ATTR', 'id': 25, 'name': 'white'}, {'supercategory': 'ATTR', 'id': 26, 'name': 'light_yellow'}, {'supercategory': 'ATTR', 'id': 27, 'name': 'yellow'}, {'supercategory': 'ATTR', 'id': 28, 'name': 'dark_yellow'}, {'supercategory': 'ATTR', 'id': 29, 'name': 'other(color)'}, {'supercategory': 'ATTR', 'id': 30, 'name': 'plain'}, {'supercategory': 'ATTR', 'id': 31, 'name': 'striped'}, {'supercategory': 'ATTR', 'id': 32, 'name': 'dotted'}, {'supercategory': 'ATTR', 'id': 33, 'name': 'checkered'}, {'supercategory': 'ATTR', 'id': 34, 'name': 'woven'}, {'supercategory': 'ATTR', 'id': 35, 'name': 'studded'}, {'supercategory': 'ATTR', 'id': 36, 'name': 'perforated'}, {'supercategory': 'ATTR', 'id': 37, 'name': 'floral'}, {'supercategory': 'ATTR', 'id': 38, 'name': 'other(pattern_marking)'}, {'supercategory': 'ATTR', 'id': 39, 'name': 'logo'}, {'supercategory': 'ATTR', 'id': 40, 'name': 'text'}, {'supercategory': 'ATTR', 'id': 41, 'name': 'stone'}, {'supercategory': 'ATTR', 'id': 42, 'name': 'wood'}, {'supercategory': 'ATTR', 'id': 43, 'name': 'rattan'}, {'supercategory': 'ATTR', 'id': 44, 'name': 'fabric'}, {'supercategory': 'ATTR', 'id': 45, 'name': 'crochet'}, {'supercategory': 'ATTR', 'id': 46, 'name': 'wool'}, {'supercategory': 'ATTR', 'id': 47, 'name': 'leather'}, {'supercategory': 'ATTR', 'id': 48, 'name': 'velvet'}, {'supercategory': 'ATTR', 'id': 49, 'name': 'metal'}, {'supercategory': 'ATTR', 'id': 50, 'name': 'paper'}, {'supercategory': 'ATTR', 'id': 51, 'name': 'plastic'}, {'supercategory': 'ATTR', 'id': 52, 'name': 'glass'}, {'supercategory': 'ATTR', 'id': 53, 'name': 'ceramic'}, {'supercategory': 'ATTR', 'id': 54, 'name': 'other(material)'}, {'supercategory': 'ATTR', 'id': 55, 'name': 'opaque'}, {'supercategory': 'ATTR', 'id': 56, 'name': 'translucent'}, {'supercategory': 'ATTR', 'id': 57, 'name': 'transparent'}, {'supercategory': 'ATTR', 'id': 58, 'name': 'other(transparency)'}]

def mean_attr_score_per_cat(res_info):
    lista = []
    
    # for cat in [c for c in PACO_CATEGORIES if c not in PACO_NOVEL_CATEGORIES]:
    for cat in PACO_NOVEL_CATEGORIES:
        scores = []
        for attr in PACO_ATTRIBUTES:
            pos = res_info.find("'{}:{}': ".format(cat['name'], attr['name']))
            longi = len("'{}:{}': ".format(cat['name'], attr['name']))

            if(pos > -1):
                valor_str = res_info[pos+longi : pos+longi+12]
                if ',' not in valor_str and '}' not in valor_str:
                    scores.append(float(valor_str))
                else:
                    scores.append(float(valor_str[:3]))

        if(len(scores) > 0):
            lista.append(sum(scores) / len(scores))
        else:
            lista.append(-1)

    return lista

def main():
    parser = argparse.ArgumentParser()
    parser.add_argument('--res-dir', type=str, default='', help='Path to the results')
    parser.add_argument('--shot-list', type=int, nargs='+', default=[1,2,3,5,10,30], help='')
    args = parser.parse_args()

    wf = open(os.path.join(args.res_dir, 'results_attr_per_cat.txt'), 'w')

    for shot in args.shot_list:

        file_paths = []
        for fid, fname in enumerate(os.listdir(args.res_dir)):
            if fname.split('_')[0] != '{}shot'.format(shot):
                continue
            _dir = os.path.join(args.res_dir, fname)
            if not os.path.isdir(_dir):
                continue
            file_paths.append(os.path.join(_dir, 'log.txt'))

        header = [cat['name'] for cat in PACO_NOVEL_CATEGORIES]
        results = []
        for fid, fpath in enumerate(sorted(file_paths)):
            lineinfos = open(fpath).readlines()
            res_info = lineinfos[-5]
            results.append([fid] + mean_attr_score_per_cat(res_info))

        results_np = np.array(results)
        avg = np.mean(results_np, axis=0).tolist()
        cid = [s for s in np.std(results_np, axis=0)]
        results.append(['μ'] + avg[1:])
        results.append(['c'] + cid[1:])

        table = tabulate(
            results,
            tablefmt="pipe",
            floatfmt=".2f",
            headers=[''] + header,
            numalign="left",
        )

        wf.write('--> {}-shot\n'.format(shot))
        wf.write('{}\n\n'.format(table))
        wf.flush()
    wf.close()

    print('Reformat attr results per cat -> {}'.format(os.path.join(args.res_dir, 'results_attr_per_cat.txt')))


if __name__ == '__main__':
    main()
